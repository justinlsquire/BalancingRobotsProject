// NOTE: word art generated from here: http://patorjk.com/software/taag/ - font 'Big' - default settings

/*---------------------------------------------------------------------------------------------------------------

  _____        __ _              _      _ _                    _           
 |  __ \      / _(_)            | |    (_) |                  (_)          
 | |  | | ___| |_ _ _ __   ___  | |     _| |__  _ __ __ _ _ __ _  ___  ___ 
 | |  | |/ _ \  _| | '_ \ / _ \ | |    | | '_ \| '__/ _` | '__| |/ _ \/ __|
 | |__| |  __/ | | | | | |  __/ | |____| | |_) | | | (_| | |  | |  __/\__ \
 |_____/ \___|_| |_|_| |_|\___| |______|_|_.__/|_|  \__,_|_|  |_|\___||___/                                                                                                                                                   
/*---------------------------------------------------------------------------------------------------------------*/

// hardware-dependent library for robots
// Choose which library to use, based on the hardware
//#include<BALBOA.h> 
#include <MINSEG.h>
// platform-independent control and estimation library
#include <SEG_CONTROL.h> 
#include <ctrlTest.h>

// create object for the robot (either Minseg or Balboa)
// but it must be called 'robot' for the code to work correctly
//Balboa robot; // - not ready yet
Minseg robot; 

// create object for the controller (universal)
segControl controller;


//*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^**^*^*^*
//*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^**^*^*^*
//*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^**^*^*^*


/*---------------------------------------------------------------------------------------------------------------
  ____             _                          _       _                _____      _               
 |  _ \           (_)           /\           | |     (_)              / ____|    | |              
 | |_) | ___  __ _ _ _ __      /  \   _ __ __| |_   _ _ _ __   ___   | (___   ___| |_ _   _ _ __  
 |  _ < / _ \/ _` | | '_ \    / /\ \ | '__/ _` | | | | | '_ \ / _ \   \___ \ / _ \ __| | | | '_ \ 
 | |_) |  __/ (_| | | | | |  / ____ \| | | (_| | |_| | | | | | (_) |  ____) |  __/ |_| |_| | |_) |
 |____/ \___|\__, |_|_| |_| /_/    \_\_|  \__,_|\__,_|_|_| |_|\___/  |_____/ \___|\__|\__,_| .__/ 
              __/ |                                                                        | |    
             |___/                                                                         |_|    
/*---------------------------------------------------------------------------------------------------------------*/
void setup() {
  // delay - temporary for debugging
  delay(3000);
  // initialize the serial port for communications
  Serial.begin(115200);

  // call the library function to set up and initialize all
  // the platform specific hardware (ports, pins, peripherals, etc.)
  robot.setupHardware(); // sets up all of the stock hardware on the robot

  // configure the controller for this application
  controller.updateRate = 100; // 100 Hz - per function documentation
  // other stuff

  // call the libarary function to take these parameters just entered
  // and do some background calculations to set up the controller for 
  // being ready to use
  controller.setupController();
} // end of setup()
/*---------------------------------------------------------------------------------------------------------------
  ______           _                    _       _                _____      _               
 |  ____|         | |     /\           | |     (_)              / ____|    | |              
 | |__   _ __   __| |    /  \   _ __ __| |_   _ _ _ __   ___   | (___   ___| |_ _   _ _ __  
 |  __| | '_ \ / _` |   / /\ \ | '__/ _` | | | | | '_ \ / _ \   \___ \ / _ \ __| | | | '_ \ 
 | |____| | | | (_| |  / ____ \| | | (_| | |_| | | | | | (_) |  ____) |  __/ |_| |_| | |_) |
 |______|_| |_|\__,_| /_/    \_\_|  \__,_|\__,_|_|_| |_|\___/  |_____/ \___|\__|\__,_| .__/ 
                                                                                     | |    
                                                                                     |_|    
/*---------------------------------------------------------------------------------------------------------------*/

//*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^**^*^*^*
//*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^**^*^*^*
//*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^**^*^*^*

/*---------------------------------------------------------------------------------------------------------------
  ____             _                          _       _               _                       
 |  _ \           (_)           /\           | |     (_)             | |                      
 | |_) | ___  __ _ _ _ __      /  \   _ __ __| |_   _ _ _ __   ___   | |     ___   ___  _ __  
 |  _ < / _ \/ _` | | '_ \    / /\ \ | '__/ _` | | | | | '_ \ / _ \  | |    / _ \ / _ \| '_ \ 
 | |_) |  __/ (_| | | | | |  / ____ \| | | (_| | |_| | | | | | (_) | | |___| (_) | (_) | |_) |
 |____/ \___|\__, |_|_| |_| /_/    \_\_|  \__,_|\__,_|_|_| |_|\___/  |______\___/ \___/| .__/ 
              __/ |                                                                    | |    
             |___/                                                                     |_|    
/*---------------------------------------------------------------------------------------------------------------*/
void loop() {

  // temp - for debugging
  delay(1000);
  Serial.println(robot.encCnt);
  //robot.setMotorPWM(255);
  //minseg.toggleLED();
  digitalWrite(8,HIGH);
  delay(1000);
  Serial.println(robot.encCnt);
  //robot.setMotorPWM(-255);
  digitalWrite(8,LOW);

  // check the timer to see if it is time to 
  // run the controller update
  if ((micros() - controller.lastUpdateTime) >= controller.updateDtMicros)
  {
    // reset the last time to the current time - so that 
    // next time we go to this loop, we will be operating 
    // on the updated value
    controller.lastUpdateTime = micros();
    // call the update function
    controllerUpdate();
  } // end of if - for time inverval check
} // end of loop()

/*---------------------------------------------------------------------------------------------------------------
  ______           _                    _       _               _                       
 |  ____|         | |     /\           | |     (_)             | |                      
 | |__   _ __   __| |    /  \   _ __ __| |_   _ _ _ __   ___   | |     ___   ___  _ __  
 |  __| | '_ \ / _` |   / /\ \ | '__/ _` | | | | | '_ \ / _ \  | |    / _ \ / _ \| '_ \ 
 | |____| | | | (_| |  / ____ \| | | (_| | |_| | | | | | (_) | | |___| (_) | (_) | |_) |
 |______|_| |_|\__,_| /_/    \_\_|  \__,_|\__,_|_|_| |_|\___/  |______\___/ \___/| .__/ 
                                                                                 | |    
                                                                                 |_|    
/*---------------------------------------------------------------------------------------------------------------*/

//*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^**^*^*^*
//*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^**^*^*^*
//*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^**^*^*^*

/*---------------------------------------------------------------------------------------------------------------
  ____             _         _    _                 ______                _   _                 
 |  _ \           (_)       | |  | |               |  ____|              | | (_)                
 | |_) | ___  __ _ _ _ __   | |  | |___  ___ _ __  | |__ _   _ _ __   ___| |_ _  ___  _ __  ___ 
 |  _ < / _ \/ _` | | '_ \  | |  | / __|/ _ \ '__| |  __| | | | '_ \ / __| __| |/ _ \| '_ \/ __|
 | |_) |  __/ (_| | | | | | | |__| \__ \  __/ |    | |  | |_| | | | | (__| |_| | (_) | | | \__ \
 |____/ \___|\__, |_|_| |_|  \____/|___/\___|_|    |_|   \__,_|_| |_|\___|\__|_|\___/|_| |_|___/
              __/ |                                                                             
             |___/                                                                              
/*---------------------------------------------------------------------------------------------------------------*/
void controllerUpdate(void)
{
  robot.updateController();
  // update sensors - read sensor data from robot 
  //robot.updateAccel();
  //robot.updateGyro();
  //robot.updateEncoders();
  // and pass it to the controller object
  
  // accelerometer value in the vertical (gravity) direction 
//  controller.accV = robot.ay;
  // accelerometer value in the horizontal direction
 // controller.accH = robot.az;
  // gyro value around the rotational axis of the robot
 // controller.g = robot.gx;
  // encoder distance traveled
  //controller.enc1 = robot.x1;
  //controller.enc2 = robot.x2;
  
  //controller.getSensorData();
  // update estimator (if present)
 // controller.updateEstimator();
  // update controller output (calculate it)
  //controller.updateController();
  // update actuator with this output
  //robot.updateMotor1(controller.motorVoltage1); 
  // if the robot has two motors, uncomment and figure out this part
  //robot.updateMotor2(controller.motorVoltage2);
} // end of controller update

/*---------------------------------------------------------------------------------------------------------------
  ______           _   _    _                 ______                _   _                 
 |  ____|         | | | |  | |               |  ____|              | | (_)                
 | |__   _ __   __| | | |  | |___  ___ _ __  | |__ _   _ _ __   ___| |_ _  ___  _ __  ___ 
 |  __| | '_ \ / _` | | |  | / __|/ _ \ '__| |  __| | | | '_ \ / __| __| |/ _ \| '_ \/ __|
 | |____| | | | (_| | | |__| \__ \  __/ |    | |  | |_| | | | | (__| |_| | (_) | | | \__ \
 |______|_| |_|\__,_|  \____/|___/\___|_|    |_|   \__,_|_| |_|\___|\__|_|\___/|_| |_|___/                                                                                                                                                                                    
/*---------------------------------------------------------------------------------------------------------------*/
